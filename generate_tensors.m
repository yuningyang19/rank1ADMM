% example 3.1 of Nie  works
n=2;
A1= zeros(n,n,n);
A1(1,1,1) = 1.5578; A1(2,2,2) = 1.1226; A1(1,1,2) = -2.4443; A1(1,2,1) = A1(1,1,2); A1(2,1,1) = A1(1,1,2);
A1(2,2,1) = -1.0982; A1(2,1,2) = A1(2,2,1); A1(1,2,2) = A1(2,2,1);

n=3;    % Example 3.2 of Nie works
A2=zeros(n,n,n);
A2(1,1,1)=-0.1281;A2(1,1,2)=0.0516*3; A2(1,1,3) = -0.0954*3; A2(1,2,2)=-0.1958*3;
A2(1,2,3) = -0.1790*6; A2(1,3,3)=-0.2676*3; A2(2,2,2)=0.3251; A2(2,2,3)=0.2513*3; A2(2,3,3)=0.1773*3; A2(3,3,3)=0.0338;
A2=double( symmetrize( tensor(A2)   )     );


% Example 3.3 (see [27, Example 2]). Consider the tensor F ¡Ê S 3 (R 3 ) with entries
% F 111 = 0.0517,F 112 = 0.3579,F 113 = 0.5298,F 122 = 0.7544,F 123 = 0.2156,
% F 133 = 0.3612,F 222 = 0.3943,F 223 = 0.0146,F 233 = 0.6718,F 333 = 0.9723.
n = 3; A33 = zeros(n,n,n);  %works
A33(1,1,1) = 0.0517; A33(1,1,2) = 0.3579*3; A33(1,1,3) = 0.5298*3; A33(1,2,2) = 0.7544*3; A33(1,2,3) = 0.2156*6;
A33(1,3,3) = 0.3612*3; A33(2,2,2) = 0.3943; A33(2,2,3) = 0.0146*3; A33(2,3,3) = 0.6718*3; A33(3,3,3) = 0.9723;
A33 = double(symmetrize(tensor(A33)));



n=3; % 3.4 works
A3 = zeros(n,n,n,n);
A3(1,1,1,1) = 0.2883; A3(1,1,1,2) = -0.0031*4; A3(1,1,1,3) = 0.1973*4; A3(1,1,2,2) = -0.2485*6; A3(1,1,2,3) = -0.2939*12;
A3(1,1,3,3) = 0.3847*6; A3(1,2,2,2) = 0.2972*4; A3(1,2,2,3) = 0.1862*12; A3(1,2,3,3) = 0.0919*12; A3(1,3,3,3) = -0.3619*4;
A3(2,2,2,2) = 0.1241; A3(2,2,2,3) = -0.3420*4; A3(2,2,3,3) = 0.2127*6; A3(2,3,3,3) = 0.2727*4; A3(3,3,3,3) = -0.3054;
A3 = -double(symmetrize(tensor(A3)));



% the mri data from jiang et al's paper
n=3; A4 = zeros(n,n,n,n); % strange 
A4(1,1,1,1)=0.74694; A4(1,1,1,2)=-0.435103; A4(1,1,2,2)=0.454945; A4(1,2,2,2)=0.0657818; A4(2,2,2,2)=1;
A4(1,1,1,3)=0.37089; A4(1,1,2,3)=-0.29883; A4(1,2,2,3)=-0.795157; A4(2,2,2,3)=0.139751; A4(1,1,3,3)=1.24733;
A4(1,2,3,3)=0.714359; A4(2,2,3,3)=0.316264; A4(1,3,3,3)=-0.397391; A4(2,3,3,3)=-0.405544; A4(3,3,3,3)=0.794869;
A4 =  double(symmetrize(tensor(A4)));



% Example 3.5   works
n = 5; A5 = zeros(n,n,n);
for i = 1: n
    for j = 1: n
        for k = 1: n
            A5(i,j,k) = (-1)^i/i + (-1)^j/j + (-1)^k/k;
        end
    end
end

n=5; A6 = zeros(n,n,n,n);   % works
for i = 1: n
    for j = 1: n
        for k = 1: n
            for l = 1: n
                A6(i,j,k,l) = atan( (-1)^i * i/n) + atan( (-1)^j * j/n) + atan( (-1)^k * k/n) + atan( (-1)^l * l/n);
            end
        end
    end
end

n=5; A7 = zeros(n,n,n,n);   % works
for i = 1: n
    for j = 1: n
        for k = 1: n
            for l = 1: n
                A7(i,j,k,l) = sin(i+j+k+l);
            end
        end
    end
end

n=5; A8 = zeros(n,n,n);   % works
for i = 1: n
    for j = 1: n
        for k = 1: n
                A8(i,j,k) = sin(i+j+k);
        end
    end
end

n=15; A9 = zeros(n,n,n,n);
for i1 = 1:n
    for i2 = 1:n
        for i3=1:n
            for i4=1:n
                for i5=1:n
                    A9(i1,i2,i3,i4,i5) = (-1)^i1*log(i1) + (-1)^i2*log(i2) + (-1)^i3*log(i3) + (-1)^i4*log(i4) + (-1)^i5*log(i5);
                end
            end
        end
    end
end

frob(A9)

